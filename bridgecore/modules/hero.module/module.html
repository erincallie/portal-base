{% macro waves(this_name) %}
  {% if this_name == "wave_1" %}
    <svg class="{{ this_name }}" viewBox="0 0 1440 260" version="1.1" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="sw-gradient-0" x1="0" x2="0" y1="1" y2="0"><stop stop-color="rgba(0, 0, 0, 1)" offset="0%"></stop><stop stop-color="rgba(0, 0, 0, 1)" offset="100%"></stop></linearGradient></defs><path style="transform:translate(0, 0px); opacity:1" fill="url(#sw-gradient-0)" d="M0,130L80,147.3C160,165,320,199,480,195C640,191,800,147,960,130C1120,113,1280,121,1440,134.3C1600,147,1760,165,1920,151.7C2080,139,2240,95,2400,86.7C2560,78,2720,104,2880,99.7C3040,95,3200,61,3360,52C3520,43,3680,61,3840,95.3C4000,130,4160,182,4320,195C4480,208,4640,182,4800,177.7C4960,173,5120,191,5280,182C5440,173,5600,139,5760,134.3C5920,130,6080,156,6240,138.7C6400,121,6560,61,6720,60.7C6880,61,7040,121,7200,160.3C7360,199,7520,217,7680,186.3C7840,156,8000,78,8160,73.7C8320,69,8480,139,8640,156C8800,173,8960,139,9120,121.3C9280,104,9440,104,9600,91C9760,78,9920,52,10080,65C10240,78,10400,130,10560,147.3C10720,165,10880,147,11040,147.3C11200,147,11360,165,11440,173.3L11520,182L11520,260L11440,260C11360,260,11200,260,11040,260C10880,260,10720,260,10560,260C10400,260,10240,260,10080,260C9920,260,9760,260,9600,260C9440,260,9280,260,9120,260C8960,260,8800,260,8640,260C8480,260,8320,260,8160,260C8000,260,7840,260,7680,260C7520,260,7360,260,7200,260C7040,260,6880,260,6720,260C6560,260,6400,260,6240,260C6080,260,5920,260,5760,260C5600,260,5440,260,5280,260C5120,260,4960,260,4800,260C4640,260,4480,260,4320,260C4160,260,4000,260,3840,260C3680,260,3520,260,3360,260C3200,260,3040,260,2880,260C2720,260,2560,260,2400,260C2240,260,2080,260,1920,260C1760,260,1600,260,1440,260C1280,260,1120,260,960,260C800,260,640,260,480,260C320,260,160,260,80,260L0,260Z"></path></svg>
  {% elif this_name == "wave_2" %}
    <svg class="{{ this_name }}" viewBox="0 0 1440 200" version="1.1" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="sw-gradient-0" x1="0" x2="0" y1="1" y2="0"><stop stop-color="rgba(0, 0, 0, 1)" offset="0%"></stop><stop stop-color="rgba(0, 0, 0, 1)" offset="100%"></stop></linearGradient></defs><path style="transform:translate(0, 0px); opacity:1" fill="url(#sw-gradient-0)" d="M0,20L80,20C160,20,320,20,480,43.3C640,67,800,113,960,120C1120,127,1280,93,1440,86.7C1600,80,1760,100,1920,116.7C2080,133,2240,147,2400,126.7C2560,107,2720,53,2880,33.3C3040,13,3200,27,3360,30C3520,33,3680,27,3840,26.7C4000,27,4160,33,4320,56.7C4480,80,4640,120,4800,123.3C4960,127,5120,93,5280,83.3C5440,73,5600,87,5760,90C5920,93,6080,87,6240,76.7C6400,67,6560,53,6720,50C6880,47,7040,53,7200,60C7360,67,7520,73,7680,83.3C7840,93,8000,107,8160,113.3C8320,120,8480,120,8640,130C8800,140,8960,160,9120,163.3C9280,167,9440,153,9600,150C9760,147,9920,153,10080,150C10240,147,10400,133,10560,106.7C10720,80,10880,40,11040,23.3C11200,7,11360,13,11440,16.7L11520,20L11520,200L11440,200C11360,200,11200,200,11040,200C10880,200,10720,200,10560,200C10400,200,10240,200,10080,200C9920,200,9760,200,9600,200C9440,200,9280,200,9120,200C8960,200,8800,200,8640,200C8480,200,8320,200,8160,200C8000,200,7840,200,7680,200C7520,200,7360,200,7200,200C7040,200,6880,200,6720,200C6560,200,6400,200,6240,200C6080,200,5920,200,5760,200C5600,200,5440,200,5280,200C5120,200,4960,200,4800,200C4640,200,4480,200,4320,200C4160,200,4000,200,3840,200C3680,200,3520,200,3360,200C3200,200,3040,200,2880,200C2720,200,2560,200,2400,200C2240,200,2080,200,1920,200C1760,200,1600,200,1440,200C1280,200,1120,200,960,200C800,200,640,200,480,200C320,200,160,200,80,200L0,200Z"></path></svg>
  {% elif this_name == "wave_3" %}
    <svg class="{{ this_name }}" viewBox="0 0 1440 180" version="1.1" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="sw-gradient-0" x1="0" x2="0" y1="1" y2="0"><stop stop-color="rgba(0, 0, 0, 1)" offset="0%"></stop><stop stop-color="rgba(0, 0, 0, 1)" offset="100%"></stop></linearGradient></defs><path style="transform:translate(0, 0px); opacity:1" fill="url(#sw-gradient-0)" d="M0,54L120,72C240,90,480,126,720,144C960,162,1200,162,1440,144C1680,126,1920,90,2160,90C2400,90,2640,126,2880,126C3120,126,3360,90,3600,66C3840,42,4080,30,4320,39C4560,48,4800,78,5040,75C5280,72,5520,36,5760,21C6000,6,6240,12,6480,21C6720,30,6960,42,7200,54C7440,66,7680,78,7920,90C8160,102,8400,114,8640,105C8880,96,9120,66,9360,54C9600,42,9840,48,10080,60C10320,72,10560,90,10800,90C11040,90,11280,72,11520,57C11760,42,12000,30,12240,48C12480,66,12720,114,12960,120C13200,126,13440,90,13680,87C13920,84,14160,114,14400,108C14640,102,14880,60,15120,36C15360,12,15600,6,15840,30C16080,54,16320,108,16560,129C16800,150,17040,138,17160,132L17280,126L17280,180L17160,180C17040,180,16800,180,16560,180C16320,180,16080,180,15840,180C15600,180,15360,180,15120,180C14880,180,14640,180,14400,180C14160,180,13920,180,13680,180C13440,180,13200,180,12960,180C12720,180,12480,180,12240,180C12000,180,11760,180,11520,180C11280,180,11040,180,10800,180C10560,180,10320,180,10080,180C9840,180,9600,180,9360,180C9120,180,8880,180,8640,180C8400,180,8160,180,7920,180C7680,180,7440,180,7200,180C6960,180,6720,180,6480,180C6240,180,6000,180,5760,180C5520,180,5280,180,5040,180C4800,180,4560,180,4320,180C4080,180,3840,180,3600,180C3360,180,3120,180,2880,180C2640,180,2400,180,2160,180C1920,180,1680,180,1440,180C1200,180,960,180,720,180C480,180,240,180,120,180L0,180Z"></path></svg>
  {% endif %}
{% endmacro %}

{% macro render_video(link) %}
  {% if link is string_containing "vidyard" %}
    <iframe src="//play.vidyard.com/{{ module.video_id }}" width='1080' height='720' style="max-width:100%; height: auto;aspect-ratio: 16 / 9;" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true"></iframe>
  {% elif link is string_containing "youtube" %}
    <iframe src='https://www.youtube.com/embed/{{ module.video_id }}?rel=0&controls=0&modestbranding=1&showinfo=0' width='1080' height='720' style="max-width:100%; height: auto;aspect-ratio: 16 / 9;" frameborder='0' allowfullscreen></iframe>
  {% elif link is string_containing "vimeo" %}
    <iframe src='https://player.vimeo.com/video/{{ module.video_id }}' width='1080' height='720' style="max-width:100%; height: auto;aspect-ratio: 16 / 9;"  frameborder='0' webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
  {% elif link is string_containing "wistia" %}
    <script src="//fast.wistia.com/embed/medias/s3lqfi0zn7.jsonp" async></script>
    <script src="//fast.wistia.com/assets/external/E-v1.js" async></script>
    <div class="wistia_embed wistia_async_{{ module.video_id }}"  width='1080' height='720' style="max-width:100%; height: auto;aspect-ratio: 16 / 9;">&nbsp;</div>                      
  {% else %}
    {% if module.video.player_id %}
    {% set max_width = module.video.size_type == 'auto_custom_max' ? module.video.max_width : module.video.width %}
    {% set max_height = module.video.size_type == 'auto_custom_max' ? module.video.max_height : module.video.height %}
    {% video_player "embed_player"
        player_id={{ module.video.player_id }}
        type={{ module.video.player_type || 'scriptV4' }}
        full_width={{ module.video.size_type == 'auto_full_width' }},
        conversion_asset={{ module.video.conversion_asset|tojson|safe }}
    %}
    {% endif %}
  {% endif %}
{% endmacro %}

<div id="{{ name }}" class="video-hero">
  <div class="video-hero__background">
    {% if module.background_options.background_video.use_file %}
      {% if module.background_options.background_video.videoplayer.player_id %}
        {% set max_width = module.background_options.background_video.videoplayer.size_type == 'auto_custom_max' ? module.background_options.background_video.videoplayer.max_width : module.background_options.background_video.videoplayer.width %}
        {% set max_height = module.background_options.background_video.videoplayer.size_type == 'auto_custom_max' ? module.background_options.background_video.videoplayer.max_height : module.background_options.background_video.videoplayer.height %}
        {% video_player "embed_player"
          player_id={{ module.background_options.background_video.videoplayer.player_id }}
          type={{ module.background_options.background_video.videoplayer.player_type || 'scriptV4' }}
          full_width={{ module.background_options.background_video.videoplayer.size_type == 'auto_full_width' }},
          conversion_asset={{ module.background_options.background_video.videoplayer.conversion_asset|tojson|safe }}
          autoplay={{ module.background_options.background_video.videoplayer.autoplay }}
          hidden_controls={{ module.background_options.background_video.videoplayer.hide_controls }}
          loop={{ module.background_options.background_video.videoplayer.loop_video }}
          muted={{ module.background_options.background_video.videoplayer.mute_by_default }}
        %}
      {% endif %}
    {% else %}
      {{ render_video(module.background_options.background_video.video_url) }}
    {% endif %}
  </div>
  <div class="video-hero__overlay"></div>
  {% if module.background_options.add_curve == "true" %}
    {% set wave_name = module.styles.curve_styles.curve_style or "wave_1" %}
    <div class="video-hero__wave">
      {{ waves(wave_name) }}
    </div>
  {% endif %}
  <div class="video-hero__container">
    <div class="video-hero__row">
      <div class="video-hero__wrap">
        {% if module.content.title %}
          <div class="video-hero__title">
            <h1>
              {{ module.content.title }}
            </h1>
          </div>
        {% endif %}
        {% if module.content.content %}
          <div class="video-hero__content">
            {{ module.content.content }}
            <div class="video-hero__buttons custom-button">
              <div class="custom-button__inner">
                {% for item in module.content.buttons %}
                  {% set href = item.link.url.href %}
                  {% if item.link.url.type is equalto "EMAIL_ADDRESS" %}
                  {% set href = "mailto:" + href %}
                  {% endif %}
                  <a href="{{ href }}" class="button button--{{ item.style }}{{ " button--ghost" if item.ghost_button == "true" }}"
                     {% if item.link.open_in_new_tab %}target="_blank"{% endif %}
                     {% if item.link.rel %}rel="{{ item.link.rel }}"{% endif %}
                     >
                    {{ item.button_text }}
                  </a>
                {% endfor %}
              </div>
            </div>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>

{% require_css %}
<style>

  #{{ name }} {
    {% if module.styles.background_styles.color %}background:{{ module.styles.background_styles.color.css }};{% endif %}
    {% if module.styles.background_styles.gradient %}background-image:{{ module.styles.background_styles.gradient.css }};{% endif %}
    {% if module.styles.background_styles.image and module.background_options.background_style == "image" %}{{ module.styles.background_styles.image.css }}{% endif %}
  }
  {% if module.background_options.overlay == "true" %}
    #{{ name }} .video-hero__overlay {
      {% if module.styles.overlay_styles.color %}background:{{ module.styles.overlay_styles.color.css }};{% endif %}
      {% if module.styles.overlay_styles.gradient %}background-image:{{ module.styles.overlay_styles.gradient.css }};{% endif %}
      {% if module.styles.overlay_styles.image %}{{ module.styles.overlay_styles.image.css }}{% endif %}
    }
  {% endif %}
  
  #{{ name }} .video-hero__container {
    {% if module.styles.module_styles.max_content_width %}max-width:{{ module.styles.module_styles.max_content_width }}px;{% endif %}
    {{ module.styles.module_styles.spacing.css }}
  }
  
  #{{ name }} .video-hero__container h1 {
    {% if module.styles.module_styles.header_font %}{{ module.styles.module_styles.header_font.css }}{% endif %}
  }
  
  #{{ name }} .video-hero__container .video-hero__content,
  #{{ name }} .video-hero__container .video-hero__content > * {
    {% if module.styles.module_styles.header_font %}{{ module.styles.module_styles.content_font.css }}{% endif %}
  }
  
  {% if module.background_options.add_curve == "true" %}
    #{{ name }} .video-hero__wave svg path {
      {% if module.styles.curve_styles.color %}fill:{{ module.styles.curve_styles.color.css }};{% endif %}
    }
    #{{ name }} .video-hero__wave {
      border-bottom: 4px;
      {% if module.styles.curve_styles.color %}border-color:{{ module.styles.curve_styles.color.css }};{% endif %}
    }
    #{{ name }} .video-hero__container {
      margin-bottom: 8vw;
    }
  {% endif %}
  
  {% if module.styles.module_styles.text_alignment %} 
    #{{ name }} .video-hero__wrap {
      text-align: {{ module.styles.module_styles.text_alignment.text_align }};
    }
  {% endif %}
 

</style>
{% end_require_css %}

{% require_js %}
<script>
$(function() {
 
  {% if module.background_options.parallax_effect == "true" %}

  const init_parallax = function(target, strength) {
    let initial_offset = "center -" + (1 * strength) + "px";
    $(target).attr("style", "background-position:" + initial_offset + " !important;background-repeat:repeat-y !important;");
    $(window).on("scroll", function() {
      let offset = "center -" + ($(window).scrollTop() * strength) + "px";
      $(target).attr("style", "background-position:" + offset + " !important;background-repeat:repeat-y !important;");
    });
  };

  init_parallax(`#{{ name }}`, {{ module.background_options.parallax_strength }});

  {% endif %}
  
  
  
  {% if module.background_options.add_curve == "true" %}
  
  const init_fix_overlap = function() {
    let hero = $(".video-hero"),
        closest_section = hero.closest(".dnd-section"),
        next_section = closest_section.next();
    next_section.addClass("z-forward");
  };
  init_fix_overlap();
  
  {% endif %}
  
});
</script>
{% end_require_js %}